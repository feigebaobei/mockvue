<template>
  <div class="testTokenSDKClient">
    <h2>测试 tokenSDKClient</h2>
    <button @click="fn">生成用于测试的pvdata</button>
    <button @click="opDidttm">生成用于测试的didttm</button>
    <button @click="setKeyStore">设置keyStore</button>
    <button @click="setPvData">设置pvdata</button>
    <!-- <basicvue></basicvue> -->
  </div>
</template>

<script>
// import { basicvue } from '@/components/oasiscare'
import tokenSDKClient from 'token-sdk-client'
// import {Base64} from 'js-base64'
// import api from '@/lib/axiosInstance'

export default {
  props: {},
  data () {
    return {
      priStr: '01837f014db7fc5acd914f53839bdb5dbf4cd80ecbbb7bf966ba9619f34b627a',
      keyStore: {
        privatekey: "01837f014db7fc5acd914f53839bdb5dbf4cd80ecbbb7bf966ba9619f34b627a"
      },
      pvData: {
        "did": "did:ttm:u043829681e922731094502ebffdf1f10389c3ad11c8a67847c68f0482e608",
        "phone": "15652684614",
        "manageDids": [
          {
            "did": "did:ttm:f08ae17a9f890e251f51d161c3d7e064a742714522c8a67847c68f0482a796",
            "idpwd": "111111",
            "relationDid": "did:ttm:a61c3d7e064a742714522c8a082731094502ebffdf1f103896c68f0482a7123",
            "type": "f",
            "isOwner": false
          },
          {
            "did": "did:ttm:a61c3d7e064a742714522c8a082731094502ebffdf1f103896c68f0482a7123",
            "idpwd": "111111",
            "relationDid": "u043829681e922731094502ebffdf1f10389c3ad11c8a67847c68f0482e608",
            "type": "a",
            "isOwner": true
          }
        ],
        "version": "1588985429",

        "property": {
          "name": "tank",
          "nickName": "hello",
          "avatar": "https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1718143317,3612074652&fm=26&gp=0.jpg"
        },
        "manageCertifies": [
          {
            "claim_sn": "8102b22a5e81e840176d9f381",
            "templateId": "001",
            "templateTitle": "荣誉证书",
            "data": {
              "name": "张坦克",
              "year": "2020",
              "startTime": "2019年10月10日",
              "endTime": "2023年10月10日"
            },
            "type": "owner"
          },
          {
            "claim_sn": "102b22a5e81e840176d9f381e",
            "templateId": "001",
            "templateTitle": "荣誉证书",
            "data": {
              "name": "张三",
              "year": "2020",
              "startTime": "2019年10月10日",
              "endTime": "2023年10月10日"
            },
            "type": "checked"
          },
          {
            "claim_sn": "02b22a5e81e840176d9f381ec",
            "templateId": "002",
            "templateTitle": "毕业证书",
            "data": {
              "name": "张坦克",
              "identity": "513436200009094961",
              "gender": "女",
              "startYear": "2007",
              "startMonth": "09",
              "startDay": "01",
              "endYear": "2013",
              "endMonth": "06",
              "endDay": "22",
              "school": "天津大学",
              "honours": "5",
              "major": "建筑系",
              "serialNumber": "abc-1234-123456"
            },
            "type": "owner"
          }
        ],
        "identityCertifies": [
          {
            "claim_sn": "2b22a5e81e840176d9f381ec6",
            "templateId": "003",
            "templateTitle": "居住证书",
            "data": {
              "name": "张三",
              "gender": "男",
              "nation": "汉",
              "identity": "513436200009094961",
              "nativePlace": "北京市朝阳区北苑红军营1号",
              "currentPlace": "北京市顺义区后沙峪三山新新家园4号楼2单元102",
              "startTime": "2019年2月1日",
              "endTime": "2029年3月3日"
            }
          },
          {
            "claim_sn": "b22a5e81e840176d9f381ec6f",
            "templateId": "004",
            "templateTitle": "身份证书",
            "data": {
              "name": "张三",
              "gender": "男",
              "nation": "汉",
              "birthYear": "1994",
              "birthMonth": "05",
              "birthDay": "26",
              "identity": "513436200009094961",
              "nativePlace": "北京市顺义区后沙峪三山新新家园4号楼2单元102"
            }
          }
        ],
        "contacts": []
      },
      didttm: {
        name: '微信',
        phone: '18512345678',
        pdid: 'did:ttm:a012349681e922731094502ebffdf1f10389c3ad11c8a67847c68f0482e608',
        node: 'https://www.xxxxx.com',
        prikey: '01837f014db7fc5acd914f53839bdb5dbf4cd80ecbbb7bf966ba9619f34b627a'
      }
    }
  },
  computed: {
    // keyStore () {
    //   return this.$store.getters.getKeyStore
    // },
    // pvData () {
    //   return this.$store.getters.getPvData
    // },
  },
  components: {
    // basicvue
  },
  methods: {
    // init () {
    // },
    // getData () {}
    fn () {
      let keys = tokenSDKClient.sm2.genKeyPair(this.priStr)
      let ct = keys.encrypt(JSON.stringify(this.pvData))
      console.log('ct', ct, `[${ct.join(', ')}]`)
      let ctt = [246, 106, 106, 40, 249, 239, 104, 205, 94, 25, 74, 123, 117, 222, 186, 157, 161, 54, 72, 5, 161, 55, 231, 22, 35, 1, 41, 120, 226, 18, 197, 95, 143, 44, 190, 238, 171, 248, 247, 163, 91, 234, 30, 56, 158, 201, 3, 172, 214, 151, 42, 167, 104, 91, 90, 12, 34, 99, 41, 73, 16, 156, 197, 27, 240, 95, 89, 51, 252, 171, 52, 232, 87, 154, 34, 228, 43, 139, 183, 122, 42, 206, 95, 175, 162, 12, 196, 31, 61, 135, 154, 160, 137, 93, 26, 177, 31, 97, 195, 26, 93, 142, 14, 163, 66, 48, 153, 98, 60, 65, 107, 237, 188, 110, 152, 175, 47, 128, 221, 46, 4, 40, 178, 209, 15, 142, 18, 104, 62, 160, 147, 193, 147, 23, 95, 27, 247, 205, 205, 100, 149, 37, 35, 181, 40, 107, 160, 37, 100, 97, 237, 97, 89, 7, 145, 223, 229, 105, 149, 165, 115, 8, 165, 57, 198, 132, 215, 62, 123, 99, 154, 38, 54, 35, 48, 89, 132, 154, 72, 35, 109, 78, 204, 152, 179, 131, 29, 136, 231, 165, 65, 0, 127, 79, 169, 1, 229, 84, 47, 131, 156, 151, 223, 191, 46, 213, 48, 111, 99, 88, 2, 66, 252, 126, 251, 23, 127, 104, 33, 40, 246, 56, 216, 44, 204, 156, 23, 64, 129, 238, 147, 71, 172, 28, 110, 153, 175, 175, 249, 124, 218, 140, 254, 247, 124, 225, 122, 68, 205, 105, 206, 139, 116, 215, 23, 146, 140, 252, 116, 99, 194, 25, 142, 252, 87, 161, 93, 253, 241, 176, 2, 189, 151, 51, 82, 209, 93, 5, 205, 12, 145, 88, 248, 215, 184, 90, 189, 140, 72, 131, 95, 0, 4, 107, 111, 143, 24, 129, 195, 155, 32, 93, 31, 153, 30, 250, 40, 128, 89, 117, 153, 229, 101, 74, 60, 220, 146, 43, 117, 238, 97, 172, 131, 126, 194, 48, 117, 150, 190, 16, 231, 32, 231, 218, 204, 239, 117, 40, 172, 9, 182, 87, 46, 201, 63, 195, 172, 90, 225, 156, 29, 81, 230, 154, 87, 104, 156, 111, 22, 77, 219, 72, 254, 150, 212, 59, 96, 235, 178, 163, 218, 82, 100, 55, 138, 124, 94, 130, 61, 191, 55, 211, 238, 34, 35, 185, 24, 216, 182, 157, 107, 119, 185, 142, 68, 220, 233, 66, 9, 228, 72, 120, 223, 20, 165, 195, 78, 102, 97, 91, 35, 66, 7, 149, 114, 4, 159, 136, 121, 37, 162, 171, 194, 79, 203, 127, 225, 89, 207, 233, 210, 72, 18, 246, 180, 224, 113, 177, 195, 73, 178, 56, 61, 104, 11, 111, 39, 229, 60, 35, 216, 23, 71, 184, 15, 75, 180, 53, 33, 117, 0, 121, 252, 50, 96, 38, 6, 110, 107, 214, 182, 133, 70, 108, 48, 82, 204, 216, 68, 252, 103, 63, 155, 105, 149, 206, 73, 188, 144, 55, 242, 119, 158, 248, 171, 62, 177, 176, 140, 194, 121, 111, 183, 13, 180, 127, 31, 147, 103, 139, 140, 6, 233, 204, 158, 162, 153, 238, 64, 170, 136, 9, 85, 39, 23, 22, 203, 252, 47, 15, 199, 50, 228, 107, 74, 230, 251, 144, 239, 112, 51, 68, 62, 247, 226, 123, 213, 226, 222, 120, 80, 53, 255, 243, 199, 94, 15, 241, 104, 153, 225, 65, 76, 120, 194, 97, 173, 230, 199, 174, 207, 93, 145, 86, 210, 117, 114, 90, 35, 111, 232, 238, 246, 208, 150, 114, 57, 56, 139, 74, 43, 163, 173, 179, 248, 190, 115, 154, 252, 239, 168, 137, 143, 12, 13, 176, 193, 183, 173, 28, 250, 186, 10, 244, 253, 232, 94, 146, 212, 249, 68, 135, 1, 102, 65, 22, 9, 218, 19, 114, 121, 157, 26, 172, 70, 172, 99, 153, 131, 41, 151, 83, 105, 179, 184, 129, 140, 168, 164, 134, 69, 202, 142, 201, 36, 159, 17, 4, 140, 148, 131, 210, 130, 204, 111, 145, 116, 109, 89, 24, 138, 180, 48, 90, 115, 60, 44, 108, 113, 112, 62, 73, 222, 180, 83, 232, 28, 251, 104, 52, 172, 121, 95, 88, 107, 225, 108, 75, 209, 163, 38, 90, 177, 39, 176, 158, 248, 138, 18, 224, 214, 218, 236, 59, 228, 7, 114, 241, 126, 72, 192, 213, 248, 141, 81, 205, 201, 50, 200, 73, 249, 48, 4, 105, 67, 108, 149, 159, 109, 235, 189, 72, 167, 150, 65, 234, 94, 166, 156, 90, 182, 89, 12, 61, 10, 66, 208, 44, 6, 187, 108, 222, 191, 0, 53, 150, 246, 230, 190, 195, 238, 6, 237, 202, 117, 53, 214, 18, 94, 242, 83, 157, 79, 86, 204, 66, 63, 61, 212, 241, 19, 229, 44, 98, 126, 18, 109, 22, 44, 176, 129, 153, 225, 145, 52, 166, 222, 7, 231, 254, 167, 39, 111, 132, 42, 7, 236, 156, 49, 33, 164, 62, 226, 174, 62, 240, 248, 137, 151, 132, 238, 128, 169, 60, 206, 160, 252, 210, 120, 213, 175, 213, 107, 57, 55, 243, 26, 27, 149, 55, 103, 71, 214, 43, 207, 9, 170, 93, 64, 223, 33, 148, 30, 214, 133, 138, 198, 251, 98, 180, 90, 115, 13, 85, 194, 20, 42, 26, 128, 162, 155, 123, 11, 25, 57, 78, 21, 83, 73, 12, 66, 228, 142, 95, 105, 76, 82, 249, 49, 197, 33618, 35398, 35673, 20062, 86, 190, 181, 183, 203, 155, 131, 234, 19, 232, 186, 192, 11, 80, 98, 194, 57, 208, 24353, 22506, 20982, 75, 204, 102, 26, 12, 183, 164, 163, 196, 92, 115, 124, 50, 163, 78, 194, 223, 119, 172, 26, 141, 12, 90, 179, 231, 71, 68, 66, 193, 94, 179, 36, 174, 24066, 250, 137, 26460, 31, 4, 26056, 215, 106, 56, 16, 134, 162, 216, 195, 116, 20, 152, 64, 98, 208, 35, 19, 14, 24200, 167, 175, 26399, 185, 170, 25937, 87, 140, 5, 80, 81, 188, 155, 65, 131, 30, 112, 254, 70, 113, 217, 50, 118, 253, 186, 99, 203, 206, 81, 169, 102, 228, 239, 194, 107, 168, 88, 105, 54, 18, 158, 10, 122, 245, 216, 104, 215, 122, 17, 4, 142, 127, 110, 69, 126, 244, 7, 192, 150, 135, 97, 30, 28, 7, 99, 64, 30, 155, 100, 245, 231, 216, 47, 95, 140, 212, 65, 232, 14, 69, 24, 194, 224, 52, 61, 90, 210, 213, 212, 162, 141, 111, 168, 249, 97, 36, 70, 57, 50, 192, 54, 33559, 35567, 35712, 20206, 207, 134, 232, 76, 174, 172, 201, 222, 192, 158, 63, 186, 51, 81, 90, 19, 253, 172, 24362, 20147, 222, 59, 43, 47, 83, 230, 200, 56, 81, 11, 241, 164, 13, 213, 172, 167, 36, 233, 98, 228, 211, 8, 45, 8, 113, 194, 251, 216, 88, 212, 63, 128, 177, 24198, 224, 15, 26554, 49, 74, 26035, 108, 222, 252, 27, 117, 164, 70, 139, 238, 250, 228, 81, 198, 189, 131, 108, 65, 24114, 59, 127, 26424, 234, 115, 25949, 160, 199, 130, 129, 152, 181, 13, 107, 249, 176, 209, 193, 80, 144, 37, 168, 138, 175, 75, 126, 179, 233, 251, 121, 31, 152, 247, 97, 150, 104, 117, 219, 44, 245, 173, 80, 76, 232, 149, 255, 212, 62, 120, 209, 240, 38, 237, 181, 102, 86, 116, 225, 193, 243, 183, 189, 108, 156, 121, 171, 68, 20, 109, 230, 239, 136, 11, 46, 207, 81, 110, 121, 255, 132, 246, 130, 218, 108, 255, 9, 110, 241, 238, 160, 205, 183, 83, 76, 183, 68, 144, 172, 106, 244, 109, 220, 137, 27475, 20047, 35587, 20118, 197, 164, 35, 209, 239, 164, 239, 106, 127, 209, 16, 130, 116, 242, 12, 222, 130, 77, 24484, 22469, 20936, 124, 29, 137, 239, 29, 200, 247, 178, 176, 11, 77, 247, 29, 223, 104, 119, 187, 91, 166, 61, 66, 75, 149, 55, 59, 172, 138, 209, 25, 131, 42, 88, 4, 194, 154, 11, 71, 181, 204, 221, 101, 114, 255, 104, 23026, 108, 130, 104, 255, 116, 180, 152, 67, 162, 116, 176, 102, 218, 4, 13, 129, 232, 238, 66, 159, 116, 192, 82, 154, 125, 18, 224, 37, 203, 43, 242, 7, 220, 127, 19, 5, 149, 136, 42, 165, 38, 4, 180, 36, 24, 193, 54, 80, 225, 101, 238, 105, 68, 76, 44, 4, 87, 188, 62, 61, 178, 147, 149, 169, 102, 5, 189, 254, 106, 160, 249, 40, 95, 83, 17, 151, 204, 24, 135, 104, 203, 240, 215, 113, 66, 200, 40, 226, 77, 199, 222, 55, 240, 56, 112, 168, 164, 0, 213, 17, 115, 223, 216, 204, 250, 13, 101, 226, 205, 114, 250, 54, 22890, 28017, 22871, 23309, 79, 206, 251, 148, 7, 121, 30, 194, 164, 145, 123, 15, 132, 2, 60, 255, 72, 212, 64, 71, 155, 123, 118, 130, 149, 24140, 31503, 31845, 86, 210, 137, 244, 185, 1, 210, 215, 84, 235, 235, 98, 60, 166, 9, 42, 22, 160, 151, 109, 210, 66, 198, 191, 45, 83, 19, 86, 1, 225, 232, 49, 253, 245, 181, 213, 105, 145, 28, 6, 137, 209, 213, 170, 195, 245, 82, 39, 86, 194, 240, 183, 142, 49, 71, 134, 4, 236, 128, 26, 190, 165, 19, 213, 244, 67, 198, 119, 102, 130, 20, 29, 241, 155, 188, 189, 105, 223, 193, 23, 87, 90, 178, 97, 141, 198, 238, 8, 209, 101, 112, 63, 126, 43, 232, 165, 164, 70, 5, 154, 67, 61, 234, 243, 184, 184, 209, 156, 9, 109, 132, 70, 65, 140, 138, 159, 11, 140, 89, 71, 110, 230, 137, 33, 74, 8, 40, 128, 34, 176, 197, 186, 9, 62, 149, 62, 17, 168, 125, 35, 123, 148, 28, 161, 202, 172, 173, 233, 81, 203, 23572, 20397, 35722, 20132, 83, 12, 238, 160, 222, 209, 130, 163, 152, 242, 107, 206, 234, 177, 61, 145, 39, 254, 24410, 20058, 157, 151, 199, 24, 69, 151, 24, 200, 220, 75, 41, 245, 30168, 247, 210, 231, 136, 8, 213, 250, 154, 113, 78, 216, 239, 27845, 10, 2, 60, 6, 176, 220, 219, 99, 113, 221, 36, 185, 195, 32, 18, 81, 153, 249, 158, 158, 239, 166, 128, 154, 216, 202, 107, 149, 202, 5, 179, 137, 132, 177, 19, 196, 150, 185, 123, 205, 210, 0, 167, 86, 168, 5, 111, 192, 128, 21440, 20019, 24187, 26439, 38549, 21448, 21424, 33421, 32370, 20815, 33999, 196, 21378, 34, 124, 186, 239, 171, 128, 60, 205, 187, 28, 135, 29, 66, 118, 127, 157, 244, 117, 21385, 20142, 24189, 39018, 20117, 21389, 21530, 27815, 23804, 20117, 23589, 26042, 25911, 23312, 22256, 46, 21418, 27081, 134, 21467, 20935, 67, 226, 137, 240, 36, 150, 43, 123, 154, 28, 248, 185, 39, 153, 139, 204, 197, 111, 103, 106, 103, 208, 24170, 121, 26514, 84, 26095, 98, 35, 122, 184, 126, 74, 120, 126, 178, 4, 209, 114, 100, 56, 212, 188, 132, 24155, 3, 26439, 12, 25871, 14, 123, 211, 89, 93, 247, 236, 172, 49, 178, 173, 160, 67, 137, 232, 151, 250, 166, 109, 109, 38, 196, 246, 111, 236, 115, 251, 116, 144, 134, 203, 151, 179, 60, 211, 12, 208, 131, 43, 105, 42, 95, 50, 203, 246, 10, 241, 231, 62, 50, 225, 230, 228, 30, 232, 101, 217, 168, 235, 201, 163, 34, 48, 3, 197, 250, 209, 2, 244, 41, 92, 140, 207, 105, 18, 134, 163, 80, 252, 249, 36488, 20129, 35644, 20087, 47, 42, 73, 179, 163, 224, 39, 182, 193, 103, 168, 48, 79, 28, 236, 122, 240, 79, 24472, 20167, 62, 12, 49, 139, 141, 121, 49, 217, 78, 132, 182, 196, 30004, 15, 175, 132, 5, 173, 233, 73, 118, 188, 122, 112, 158, 27782, 171, 252, 26, 57, 101, 199, 37, 21, 8, 106, 56, 156, 73, 99, 86, 198, 129, 193, 83, 233, 223, 163, 215, 181, 135, 125, 113, 90, 55, 229, 159, 128, 116, 184, 229, 104, 28, 71, 11, 6, 12, 165, 138, 147, 77, 201, 170, 192, 148, 48, 46, 10, 7, 71, 203, 32, 254, 174, 39, 8, 245, 63, 108, 62, 150, 21, 197, 115, 25, 192, 74, 158, 61, 94, 22, 64, 125, 68, 125, 238, 140, 86, 183, 7, 7, 54, 252, 201, 47, 189, 6, 156, 186, 87, 166, 112, 88, 211, 225, 215, 93, 92, 21473, 20221, 24300, 39111, 20166, 21481, 21678, 27796, 23619, 20032, 23759, 26025, 26067, 23513, 22180, 40, 21450, 27124, 160, 21354, 20801, 43, 156, 233, 225, 155, 66, 96, 129, 149, 135, 105, 154, 56, 68, 142, 221, 190, 128, 220, 254, 252, 234, 149, 4, 63, 173, 212, 118, 220, 252, 174, 233, 139, 110, 100, 193, 60, 100, 7, 211, 225, 73, 203, 75, 54, 69, 49, 151, 142, 169, 178, 172, 212, 200, 138, 191, 117, 21, 220, 71, 173, 113, 69, 125, 236, 251, 74, 223, 202, 108, 139, 5, 45, 57, 138, 171, 8, 119, 46, 50, 218, 4, 132, 86, 237, 216, 173, 102, 171, 85, 250, 226, 158, 223, 129, 128, 200, 131, 133, 1, 33680, 35395, 35622, 20202, 64, 96, 139, 8, 78, 236, 150, 18, 20, 49, 165, 247, 71, 165, 112, 95, 116, 244, 24483, 19980, 195, 199, 91, 177, 72, 16, 61, 146, 209, 183, 13, 62, 233, 221, 243, 27, 8, 104, 245, 199, 12, 174, 246, 161, 26, 38, 119, 202, 127, 58, 64, 138, 3, 24307, 124, 121, 26391, 247, 235, 26024, 73, 207, 57, 74, 32, 105, 247, 248, 111, 178, 218, 176, 154, 35, 59, 30, 218, 24302, 183, 85, 26566, 175, 210, 26074, 98, 175, 124, 198, 164, 60, 2, 60, 194, 82, 83, 168, 219, 107, 4, 0, 177, 125, 17]
      // let mt = keys.decrypt(ct)
      let mt = tokenSDKClient.decryptPvData(ct, this.priStr)
      console.log('mt', mt)
      mt = tokenSDKClient.decryptPvData(ctt, this.priStr)
      console.log('mt', mt)
    },
    setKeyStore () {
      this.$store.dispatch('modifyKeyStore', {keyStore: this.keyStore}).catch(err => {
        console.log('err', err)
      })
    },
    setPvData () {
      this.$store.dispatch('modifyPvData', {pvData: this.pvData})
      this.$store.dispatch('modifyHasPvData', {hasPvData: true})
    },
    opDidttm () {
      // 客户端加密，服务端解密
      let ct = tokenSDKClient.encryptDidttm(JSON.stringify(this.didttm), '123456')
      console.log('ct', ct)
      let mt = tokenSDKClient.decryptDidttm(ct, '123456')
      console.log('mt', mt)
      // console.log('ct', JSON.stringify(this.didttm))
    }
  },
  created () {},
  mounted () {
    // this.init()
  }
}
</script>

<style lang="stylus" scoped>

  // .testTokenSDKClient

</style>
